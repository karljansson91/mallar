{"ast":null,"code":"// Generated by CoffeeScript 1.12.1\n(function () {\n  var PDFImage;\n  PDFImage = require('../image');\n  module.exports = {\n    initImages: function () {\n      this._imageRegistry = {};\n      return this._imageCount = 0;\n    },\n    image: function (src, x, y, options) {\n      var base, bh, bp, bw, h, hp, image, ip, name, ref, ref1, ref2, ref3, w, wp;\n\n      if (options == null) {\n        options = {};\n      }\n\n      if (typeof x === 'object') {\n        options = x;\n        x = null;\n      }\n\n      x = (ref = x != null ? x : options.x) != null ? ref : this.x;\n      y = (ref1 = y != null ? y : options.y) != null ? ref1 : this.y;\n\n      if (typeof src === 'string') {\n        image = this._imageRegistry[src];\n      }\n\n      if (!image) {\n        if (src.width && src.height) {\n          image = src;\n        } else {\n          image = this.openImage(src);\n        }\n      }\n\n      if (!image.obj) {\n        image.embed(this);\n      }\n\n      if ((base = this.page.xobjects)[name = image.label] == null) {\n        base[name] = image.obj;\n      }\n\n      w = options.width || image.width;\n      h = options.height || image.height;\n\n      if (options.width && !options.height) {\n        wp = w / image.width;\n        w = image.width * wp;\n        h = image.height * wp;\n      } else if (options.height && !options.width) {\n        hp = h / image.height;\n        w = image.width * hp;\n        h = image.height * hp;\n      } else if (options.scale) {\n        w = image.width * options.scale;\n        h = image.height * options.scale;\n      } else if (options.fit) {\n        ref2 = options.fit, bw = ref2[0], bh = ref2[1];\n        bp = bw / bh;\n        ip = image.width / image.height;\n\n        if (ip > bp) {\n          w = bw;\n          h = bw / ip;\n        } else {\n          h = bh;\n          w = bh * ip;\n        }\n      } else if (options.cover) {\n        ref3 = options.cover, bw = ref3[0], bh = ref3[1];\n        bp = bw / bh;\n        ip = image.width / image.height;\n\n        if (ip > bp) {\n          h = bh;\n          w = bh * ip;\n        } else {\n          w = bw;\n          h = bw / ip;\n        }\n      }\n\n      if (options.fit || options.cover) {\n        if (options.align === 'center') {\n          x = x + bw / 2 - w / 2;\n        } else if (options.align === 'right') {\n          x = x + bw - w;\n        }\n\n        if (options.valign === 'center') {\n          y = y + bh / 2 - h / 2;\n        } else if (options.valign === 'bottom') {\n          y = y + bh - h;\n        }\n      }\n\n      if (this.y === y) {\n        this.y += h;\n      }\n\n      this.save();\n      this.transform(w, 0, 0, -h, x, y + h);\n      this.addContent(\"/\" + image.label + \" Do\");\n      this.restore();\n      return this;\n    },\n    openImage: function (src) {\n      var image;\n\n      if (typeof src === 'string') {\n        image = this._imageRegistry[src];\n      }\n\n      if (!image) {\n        image = PDFImage.open(src, 'I' + ++this._imageCount);\n\n        if (typeof src === 'string') {\n          this._imageRegistry[src] = image;\n        }\n      }\n\n      return image;\n    }\n  };\n}).call(this);","map":{"version":3,"sources":["/Users/kaja/Code/mallar/node_modules/pdfkit/js/mixins/images.js"],"names":["PDFImage","require","module","exports","initImages","_imageRegistry","_imageCount","image","src","x","y","options","base","bh","bp","bw","h","hp","ip","name","ref","ref1","ref2","ref3","w","wp","width","height","openImage","obj","embed","page","xobjects","label","scale","fit","cover","align","valign","save","transform","addContent","restore","open","call"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.1\n(function() {\n  var PDFImage;\n\n  PDFImage = require('../image');\n\n  module.exports = {\n    initImages: function() {\n      this._imageRegistry = {};\n      return this._imageCount = 0;\n    },\n    image: function(src, x, y, options) {\n      var base, bh, bp, bw, h, hp, image, ip, name, ref, ref1, ref2, ref3, w, wp;\n      if (options == null) {\n        options = {};\n      }\n      if (typeof x === 'object') {\n        options = x;\n        x = null;\n      }\n      x = (ref = x != null ? x : options.x) != null ? ref : this.x;\n      y = (ref1 = y != null ? y : options.y) != null ? ref1 : this.y;\n      if (typeof src === 'string') {\n        image = this._imageRegistry[src];\n      }\n      if (!image) {\n        if (src.width && src.height) {\n          image = src;\n        } else {\n          image = this.openImage(src);\n        }\n      }\n      if (!image.obj) {\n        image.embed(this);\n      }\n      if ((base = this.page.xobjects)[name = image.label] == null) {\n        base[name] = image.obj;\n      }\n      w = options.width || image.width;\n      h = options.height || image.height;\n      if (options.width && !options.height) {\n        wp = w / image.width;\n        w = image.width * wp;\n        h = image.height * wp;\n      } else if (options.height && !options.width) {\n        hp = h / image.height;\n        w = image.width * hp;\n        h = image.height * hp;\n      } else if (options.scale) {\n        w = image.width * options.scale;\n        h = image.height * options.scale;\n      } else if (options.fit) {\n        ref2 = options.fit, bw = ref2[0], bh = ref2[1];\n        bp = bw / bh;\n        ip = image.width / image.height;\n        if (ip > bp) {\n          w = bw;\n          h = bw / ip;\n        } else {\n          h = bh;\n          w = bh * ip;\n        }\n      } else if (options.cover) {\n        ref3 = options.cover, bw = ref3[0], bh = ref3[1];\n        bp = bw / bh;\n        ip = image.width / image.height;\n        if (ip > bp) {\n          h = bh;\n          w = bh * ip;\n        } else {\n          w = bw;\n          h = bw / ip;\n        }\n      }\n      if (options.fit || options.cover) {\n        if (options.align === 'center') {\n          x = x + bw / 2 - w / 2;\n        } else if (options.align === 'right') {\n          x = x + bw - w;\n        }\n        if (options.valign === 'center') {\n          y = y + bh / 2 - h / 2;\n        } else if (options.valign === 'bottom') {\n          y = y + bh - h;\n        }\n      }\n      if (this.y === y) {\n        this.y += h;\n      }\n      this.save();\n      this.transform(w, 0, 0, -h, x, y + h);\n      this.addContent(\"/\" + image.label + \" Do\");\n      this.restore();\n      return this;\n    },\n    openImage: function(src) {\n      var image;\n      if (typeof src === 'string') {\n        image = this._imageRegistry[src];\n      }\n      if (!image) {\n        image = PDFImage.open(src, 'I' + (++this._imageCount));\n        if (typeof src === 'string') {\n          this._imageRegistry[src] = image;\n        }\n      }\n      return image;\n    }\n  };\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}