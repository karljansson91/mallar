{"ast":null,"code":"// Generated by CoffeeScript 1.12.1\n\n/*\nPDFReference - represents a reference to another object in the PDF object heirarchy\nBy Devon Govett\n */\n(function () {\n  var PDFObject,\n      PDFReference,\n      stream,\n      zlib,\n      bind = function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  },\n      extend = function (child, parent) {\n    for (var key in parent) {\n      if (hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n      hasProp = {}.hasOwnProperty;\n\n  zlib = require('zlib');\n  stream = require('stream');\n\n  PDFReference = function (superClass) {\n    extend(PDFReference, superClass);\n\n    function PDFReference(document, id, data) {\n      this.document = document;\n      this.id = id;\n      this.data = data != null ? data : {};\n      this.finalize = bind(this.finalize, this);\n\n      PDFReference.__super__.constructor.call(this, {\n        decodeStrings: false\n      });\n\n      this.gen = 0;\n      this.deflate = null;\n      this.compress = this.document.compress && !this.data.Filter;\n      this.uncompressedLength = 0;\n      this.chunks = [];\n    }\n\n    PDFReference.prototype.initDeflate = function () {\n      this.data.Filter = 'FlateDecode';\n      this.deflate = zlib.createDeflate();\n      this.deflate.on('data', function (_this) {\n        return function (chunk) {\n          _this.chunks.push(chunk);\n\n          return _this.data.Length += chunk.length;\n        };\n      }(this));\n      return this.deflate.on('end', this.finalize);\n    };\n\n    PDFReference.prototype._write = function (chunk, encoding, callback) {\n      var base;\n\n      if (!Buffer.isBuffer(chunk)) {\n        chunk = new Buffer(chunk + '\\n', 'binary');\n      }\n\n      this.uncompressedLength += chunk.length;\n\n      if ((base = this.data).Length == null) {\n        base.Length = 0;\n      }\n\n      if (this.compress) {\n        if (!this.deflate) {\n          this.initDeflate();\n        }\n\n        this.deflate.write(chunk);\n      } else {\n        this.chunks.push(chunk);\n        this.data.Length += chunk.length;\n      }\n\n      return callback();\n    };\n\n    PDFReference.prototype.end = function (chunk) {\n      PDFReference.__super__.end.apply(this, arguments);\n\n      if (this.deflate) {\n        return this.deflate.end();\n      } else {\n        return this.finalize();\n      }\n    };\n\n    PDFReference.prototype.finalize = function () {\n      var chunk, i, len, ref;\n      this.offset = this.document._offset;\n\n      this.document._write(this.id + \" \" + this.gen + \" obj\");\n\n      this.document._write(PDFObject.convert(this.data));\n\n      if (this.chunks.length) {\n        this.document._write('stream');\n\n        ref = this.chunks;\n\n        for (i = 0, len = ref.length; i < len; i++) {\n          chunk = ref[i];\n\n          this.document._write(chunk);\n        }\n\n        this.chunks.length = 0;\n\n        this.document._write('\\nendstream');\n      }\n\n      this.document._write('endobj');\n\n      return this.document._refEnd(this);\n    };\n\n    PDFReference.prototype.toString = function () {\n      return this.id + \" \" + this.gen + \" R\";\n    };\n\n    return PDFReference;\n  }(stream.Writable);\n\n  module.exports = PDFReference;\n  PDFObject = require('./object');\n}).call(this);","map":{"version":3,"sources":["/Users/kaja/Code/mallar/node_modules/pdfkit/js/reference.js"],"names":["PDFObject","PDFReference","stream","zlib","bind","fn","me","apply","arguments","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","require","superClass","document","id","data","finalize","decodeStrings","gen","deflate","compress","Filter","uncompressedLength","chunks","initDeflate","createDeflate","on","_this","chunk","push","Length","length","_write","encoding","callback","base","Buffer","isBuffer","write","end","i","len","ref","offset","_offset","convert","_refEnd","toString","Writable","module","exports"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.1\n\n/*\nPDFReference - represents a reference to another object in the PDF object heirarchy\nBy Devon Govett\n */\n\n(function() {\n  var PDFObject, PDFReference, stream, zlib,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  zlib = require('zlib');\n\n  stream = require('stream');\n\n  PDFReference = (function(superClass) {\n    extend(PDFReference, superClass);\n\n    function PDFReference(document, id, data) {\n      this.document = document;\n      this.id = id;\n      this.data = data != null ? data : {};\n      this.finalize = bind(this.finalize, this);\n      PDFReference.__super__.constructor.call(this, {\n        decodeStrings: false\n      });\n      this.gen = 0;\n      this.deflate = null;\n      this.compress = this.document.compress && !this.data.Filter;\n      this.uncompressedLength = 0;\n      this.chunks = [];\n    }\n\n    PDFReference.prototype.initDeflate = function() {\n      this.data.Filter = 'FlateDecode';\n      this.deflate = zlib.createDeflate();\n      this.deflate.on('data', (function(_this) {\n        return function(chunk) {\n          _this.chunks.push(chunk);\n          return _this.data.Length += chunk.length;\n        };\n      })(this));\n      return this.deflate.on('end', this.finalize);\n    };\n\n    PDFReference.prototype._write = function(chunk, encoding, callback) {\n      var base;\n      if (!Buffer.isBuffer(chunk)) {\n        chunk = new Buffer(chunk + '\\n', 'binary');\n      }\n      this.uncompressedLength += chunk.length;\n      if ((base = this.data).Length == null) {\n        base.Length = 0;\n      }\n      if (this.compress) {\n        if (!this.deflate) {\n          this.initDeflate();\n        }\n        this.deflate.write(chunk);\n      } else {\n        this.chunks.push(chunk);\n        this.data.Length += chunk.length;\n      }\n      return callback();\n    };\n\n    PDFReference.prototype.end = function(chunk) {\n      PDFReference.__super__.end.apply(this, arguments);\n      if (this.deflate) {\n        return this.deflate.end();\n      } else {\n        return this.finalize();\n      }\n    };\n\n    PDFReference.prototype.finalize = function() {\n      var chunk, i, len, ref;\n      this.offset = this.document._offset;\n      this.document._write(this.id + \" \" + this.gen + \" obj\");\n      this.document._write(PDFObject.convert(this.data));\n      if (this.chunks.length) {\n        this.document._write('stream');\n        ref = this.chunks;\n        for (i = 0, len = ref.length; i < len; i++) {\n          chunk = ref[i];\n          this.document._write(chunk);\n        }\n        this.chunks.length = 0;\n        this.document._write('\\nendstream');\n      }\n      this.document._write('endobj');\n      return this.document._refEnd(this);\n    };\n\n    PDFReference.prototype.toString = function() {\n      return this.id + \" \" + this.gen + \" R\";\n    };\n\n    return PDFReference;\n\n  })(stream.Writable);\n\n  module.exports = PDFReference;\n\n  PDFObject = require('./object');\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}