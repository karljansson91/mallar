{"ast":null,"code":"// Generated by CoffeeScript 1.12.1\n\n/*\nPDFDocument - represents an entire PDF document\nBy Devon Govett\n */\n(function () {\n  var PDFDocument,\n      PDFObject,\n      PDFPage,\n      PDFReference,\n      fs,\n      stream,\n      extend = function (child, parent) {\n    for (var key in parent) {\n      if (hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n      hasProp = {}.hasOwnProperty;\n\n  stream = require('stream');\n  fs = require('fs');\n  PDFObject = require('./object');\n  PDFReference = require('./reference');\n  PDFPage = require('./page');\n\n  PDFDocument = function (superClass) {\n    var mixin;\n    extend(PDFDocument, superClass);\n\n    function PDFDocument(options1) {\n      var key, ref1, ref2, val;\n      this.options = options1 != null ? options1 : {};\n\n      PDFDocument.__super__.constructor.apply(this, arguments);\n\n      this.version = 1.3;\n      this.compress = (ref1 = this.options.compress) != null ? ref1 : true;\n      this._pageBuffer = [];\n      this._pageBufferStart = 0;\n      this._offsets = [];\n      this._waiting = 0;\n      this._ended = false;\n      this._offset = 0;\n      this._root = this.ref({\n        Type: 'Catalog',\n        Pages: this.ref({\n          Type: 'Pages',\n          Count: 0,\n          Kids: []\n        })\n      });\n      this.page = null;\n      this.initColor();\n      this.initVector();\n      this.initFonts();\n      this.initText();\n      this.initImages();\n      this.info = {\n        Producer: 'PDFKit',\n        Creator: 'PDFKit',\n        CreationDate: new Date()\n      };\n\n      if (this.options.info) {\n        ref2 = this.options.info;\n\n        for (key in ref2) {\n          val = ref2[key];\n          this.info[key] = val;\n        }\n      }\n\n      this._write(\"%PDF-\" + this.version);\n\n      this._write(\"%\\xFF\\xFF\\xFF\\xFF\");\n\n      if (this.options.autoFirstPage !== false) {\n        this.addPage();\n      }\n    }\n\n    mixin = function (methods) {\n      var method, name, results;\n      results = [];\n\n      for (name in methods) {\n        method = methods[name];\n        results.push(PDFDocument.prototype[name] = method);\n      }\n\n      return results;\n    };\n\n    mixin(require('./mixins/color'));\n    mixin(require('./mixins/vector'));\n    mixin(require('./mixins/fonts'));\n    mixin(require('./mixins/text'));\n    mixin(require('./mixins/images'));\n    mixin(require('./mixins/annotations'));\n\n    PDFDocument.prototype.addPage = function (options) {\n      var pages;\n\n      if (options == null) {\n        options = this.options;\n      }\n\n      if (!this.options.bufferPages) {\n        this.flushPages();\n      }\n\n      this.page = new PDFPage(this, options);\n\n      this._pageBuffer.push(this.page);\n\n      pages = this._root.data.Pages.data;\n      pages.Kids.push(this.page.dictionary);\n      pages.Count++;\n      this.x = this.page.margins.left;\n      this.y = this.page.margins.top;\n      this._ctm = [1, 0, 0, 1, 0, 0];\n      this.transform(1, 0, 0, -1, 0, this.page.height);\n      this.emit('pageAdded');\n      return this;\n    };\n\n    PDFDocument.prototype.bufferedPageRange = function () {\n      return {\n        start: this._pageBufferStart,\n        count: this._pageBuffer.length\n      };\n    };\n\n    PDFDocument.prototype.switchToPage = function (n) {\n      var page;\n\n      if (!(page = this._pageBuffer[n - this._pageBufferStart])) {\n        throw new Error(\"switchToPage(\" + n + \") out of bounds, current buffer covers pages \" + this._pageBufferStart + \" to \" + (this._pageBufferStart + this._pageBuffer.length - 1));\n      }\n\n      return this.page = page;\n    };\n\n    PDFDocument.prototype.flushPages = function () {\n      var i, len, page, pages;\n      pages = this._pageBuffer;\n      this._pageBuffer = [];\n      this._pageBufferStart += pages.length;\n\n      for (i = 0, len = pages.length; i < len; i++) {\n        page = pages[i];\n        page.end();\n      }\n    };\n\n    PDFDocument.prototype.ref = function (data) {\n      var ref;\n      ref = new PDFReference(this, this._offsets.length + 1, data);\n\n      this._offsets.push(null);\n\n      this._waiting++;\n      return ref;\n    };\n\n    PDFDocument.prototype._read = function () {};\n\n    PDFDocument.prototype._write = function (data) {\n      if (!Buffer.isBuffer(data)) {\n        data = new Buffer(data + '\\n', 'binary');\n      }\n\n      this.push(data);\n      return this._offset += data.length;\n    };\n\n    PDFDocument.prototype.addContent = function (data) {\n      this.page.write(data);\n      return this;\n    };\n\n    PDFDocument.prototype._refEnd = function (ref) {\n      this._offsets[ref.id - 1] = ref.offset;\n\n      if (--this._waiting === 0 && this._ended) {\n        this._finalize();\n\n        return this._ended = false;\n      }\n    };\n\n    PDFDocument.prototype.write = function (filename, fn) {\n      var err;\n      err = new Error('PDFDocument#write is deprecated, and will be removed in a future version of PDFKit. Please pipe the document into a Node stream.');\n      console.warn(err.stack);\n      this.pipe(fs.createWriteStream(filename));\n      this.end();\n      return this.once('end', fn);\n    };\n\n    PDFDocument.prototype.output = function (fn) {\n      throw new Error('PDFDocument#output is deprecated, and has been removed from PDFKit. Please pipe the document into a Node stream.');\n    };\n\n    PDFDocument.prototype.end = function () {\n      var font, key, name, ref1, ref2, val;\n      this.flushPages();\n      this._info = this.ref();\n      ref1 = this.info;\n\n      for (key in ref1) {\n        val = ref1[key];\n\n        if (typeof val === 'string') {\n          val = new String(val);\n        }\n\n        this._info.data[key] = val;\n      }\n\n      this._info.end();\n\n      ref2 = this._fontFamilies;\n\n      for (name in ref2) {\n        font = ref2[name];\n        font.finalize();\n      }\n\n      this._root.end();\n\n      this._root.data.Pages.end();\n\n      if (this._waiting === 0) {\n        return this._finalize();\n      } else {\n        return this._ended = true;\n      }\n    };\n\n    PDFDocument.prototype._finalize = function (fn) {\n      var i, len, offset, ref1, xRefOffset;\n      xRefOffset = this._offset;\n\n      this._write(\"xref\");\n\n      this._write(\"0 \" + (this._offsets.length + 1));\n\n      this._write(\"0000000000 65535 f \");\n\n      ref1 = this._offsets;\n\n      for (i = 0, len = ref1.length; i < len; i++) {\n        offset = ref1[i];\n        offset = ('0000000000' + offset).slice(-10);\n\n        this._write(offset + ' 00000 n ');\n      }\n\n      this._write('trailer');\n\n      this._write(PDFObject.convert({\n        Size: this._offsets.length + 1,\n        Root: this._root,\n        Info: this._info\n      }));\n\n      this._write('startxref');\n\n      this._write(\"\" + xRefOffset);\n\n      this._write('%%EOF');\n\n      return this.push(null);\n    };\n\n    PDFDocument.prototype.toString = function () {\n      return \"[object PDFDocument]\";\n    };\n\n    return PDFDocument;\n  }(stream.Readable);\n\n  module.exports = PDFDocument;\n}).call(this);","map":{"version":3,"sources":["/Users/kaja/Code/mallar/node_modules/pdfkit/js/document.js"],"names":["PDFDocument","PDFObject","PDFPage","PDFReference","fs","stream","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","require","superClass","mixin","options1","ref1","ref2","val","options","apply","arguments","version","compress","_pageBuffer","_pageBufferStart","_offsets","_waiting","_ended","_offset","_root","ref","Type","Pages","Count","Kids","page","initColor","initVector","initFonts","initText","initImages","info","Producer","Creator","CreationDate","Date","_write","autoFirstPage","addPage","methods","method","name","results","push","pages","bufferPages","flushPages","data","dictionary","x","margins","left","y","top","_ctm","transform","height","emit","bufferedPageRange","start","count","length","switchToPage","n","Error","i","len","end","_read","Buffer","isBuffer","addContent","write","_refEnd","id","offset","_finalize","filename","fn","err","console","warn","stack","pipe","createWriteStream","once","output","font","_info","String","_fontFamilies","finalize","xRefOffset","slice","convert","Size","Root","Info","toString","Readable","module","exports"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.1\n\n/*\nPDFDocument - represents an entire PDF document\nBy Devon Govett\n */\n\n(function() {\n  var PDFDocument, PDFObject, PDFPage, PDFReference, fs, stream,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  stream = require('stream');\n\n  fs = require('fs');\n\n  PDFObject = require('./object');\n\n  PDFReference = require('./reference');\n\n  PDFPage = require('./page');\n\n  PDFDocument = (function(superClass) {\n    var mixin;\n\n    extend(PDFDocument, superClass);\n\n    function PDFDocument(options1) {\n      var key, ref1, ref2, val;\n      this.options = options1 != null ? options1 : {};\n      PDFDocument.__super__.constructor.apply(this, arguments);\n      this.version = 1.3;\n      this.compress = (ref1 = this.options.compress) != null ? ref1 : true;\n      this._pageBuffer = [];\n      this._pageBufferStart = 0;\n      this._offsets = [];\n      this._waiting = 0;\n      this._ended = false;\n      this._offset = 0;\n      this._root = this.ref({\n        Type: 'Catalog',\n        Pages: this.ref({\n          Type: 'Pages',\n          Count: 0,\n          Kids: []\n        })\n      });\n      this.page = null;\n      this.initColor();\n      this.initVector();\n      this.initFonts();\n      this.initText();\n      this.initImages();\n      this.info = {\n        Producer: 'PDFKit',\n        Creator: 'PDFKit',\n        CreationDate: new Date()\n      };\n      if (this.options.info) {\n        ref2 = this.options.info;\n        for (key in ref2) {\n          val = ref2[key];\n          this.info[key] = val;\n        }\n      }\n      this._write(\"%PDF-\" + this.version);\n      this._write(\"%\\xFF\\xFF\\xFF\\xFF\");\n      if (this.options.autoFirstPage !== false) {\n        this.addPage();\n      }\n    }\n\n    mixin = function(methods) {\n      var method, name, results;\n      results = [];\n      for (name in methods) {\n        method = methods[name];\n        results.push(PDFDocument.prototype[name] = method);\n      }\n      return results;\n    };\n\n    mixin(require('./mixins/color'));\n\n    mixin(require('./mixins/vector'));\n\n    mixin(require('./mixins/fonts'));\n\n    mixin(require('./mixins/text'));\n\n    mixin(require('./mixins/images'));\n\n    mixin(require('./mixins/annotations'));\n\n    PDFDocument.prototype.addPage = function(options) {\n      var pages;\n      if (options == null) {\n        options = this.options;\n      }\n      if (!this.options.bufferPages) {\n        this.flushPages();\n      }\n      this.page = new PDFPage(this, options);\n      this._pageBuffer.push(this.page);\n      pages = this._root.data.Pages.data;\n      pages.Kids.push(this.page.dictionary);\n      pages.Count++;\n      this.x = this.page.margins.left;\n      this.y = this.page.margins.top;\n      this._ctm = [1, 0, 0, 1, 0, 0];\n      this.transform(1, 0, 0, -1, 0, this.page.height);\n      this.emit('pageAdded');\n      return this;\n    };\n\n    PDFDocument.prototype.bufferedPageRange = function() {\n      return {\n        start: this._pageBufferStart,\n        count: this._pageBuffer.length\n      };\n    };\n\n    PDFDocument.prototype.switchToPage = function(n) {\n      var page;\n      if (!(page = this._pageBuffer[n - this._pageBufferStart])) {\n        throw new Error(\"switchToPage(\" + n + \") out of bounds, current buffer covers pages \" + this._pageBufferStart + \" to \" + (this._pageBufferStart + this._pageBuffer.length - 1));\n      }\n      return this.page = page;\n    };\n\n    PDFDocument.prototype.flushPages = function() {\n      var i, len, page, pages;\n      pages = this._pageBuffer;\n      this._pageBuffer = [];\n      this._pageBufferStart += pages.length;\n      for (i = 0, len = pages.length; i < len; i++) {\n        page = pages[i];\n        page.end();\n      }\n    };\n\n    PDFDocument.prototype.ref = function(data) {\n      var ref;\n      ref = new PDFReference(this, this._offsets.length + 1, data);\n      this._offsets.push(null);\n      this._waiting++;\n      return ref;\n    };\n\n    PDFDocument.prototype._read = function() {};\n\n    PDFDocument.prototype._write = function(data) {\n      if (!Buffer.isBuffer(data)) {\n        data = new Buffer(data + '\\n', 'binary');\n      }\n      this.push(data);\n      return this._offset += data.length;\n    };\n\n    PDFDocument.prototype.addContent = function(data) {\n      this.page.write(data);\n      return this;\n    };\n\n    PDFDocument.prototype._refEnd = function(ref) {\n      this._offsets[ref.id - 1] = ref.offset;\n      if (--this._waiting === 0 && this._ended) {\n        this._finalize();\n        return this._ended = false;\n      }\n    };\n\n    PDFDocument.prototype.write = function(filename, fn) {\n      var err;\n      err = new Error('PDFDocument#write is deprecated, and will be removed in a future version of PDFKit. Please pipe the document into a Node stream.');\n      console.warn(err.stack);\n      this.pipe(fs.createWriteStream(filename));\n      this.end();\n      return this.once('end', fn);\n    };\n\n    PDFDocument.prototype.output = function(fn) {\n      throw new Error('PDFDocument#output is deprecated, and has been removed from PDFKit. Please pipe the document into a Node stream.');\n    };\n\n    PDFDocument.prototype.end = function() {\n      var font, key, name, ref1, ref2, val;\n      this.flushPages();\n      this._info = this.ref();\n      ref1 = this.info;\n      for (key in ref1) {\n        val = ref1[key];\n        if (typeof val === 'string') {\n          val = new String(val);\n        }\n        this._info.data[key] = val;\n      }\n      this._info.end();\n      ref2 = this._fontFamilies;\n      for (name in ref2) {\n        font = ref2[name];\n        font.finalize();\n      }\n      this._root.end();\n      this._root.data.Pages.end();\n      if (this._waiting === 0) {\n        return this._finalize();\n      } else {\n        return this._ended = true;\n      }\n    };\n\n    PDFDocument.prototype._finalize = function(fn) {\n      var i, len, offset, ref1, xRefOffset;\n      xRefOffset = this._offset;\n      this._write(\"xref\");\n      this._write(\"0 \" + (this._offsets.length + 1));\n      this._write(\"0000000000 65535 f \");\n      ref1 = this._offsets;\n      for (i = 0, len = ref1.length; i < len; i++) {\n        offset = ref1[i];\n        offset = ('0000000000' + offset).slice(-10);\n        this._write(offset + ' 00000 n ');\n      }\n      this._write('trailer');\n      this._write(PDFObject.convert({\n        Size: this._offsets.length + 1,\n        Root: this._root,\n        Info: this._info\n      }));\n      this._write('startxref');\n      this._write(\"\" + xRefOffset);\n      this._write('%%EOF');\n      return this.push(null);\n    };\n\n    PDFDocument.prototype.toString = function() {\n      return \"[object PDFDocument]\";\n    };\n\n    return PDFDocument;\n\n  })(stream.Readable);\n\n  module.exports = PDFDocument;\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}