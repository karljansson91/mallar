"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=_interopDefault(require("@babel/runtime/helpers/extends")),_objectWithoutPropertiesLoose=_interopDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose")),_inheritsLoose=_interopDefault(require("@babel/runtime/helpers/inheritsLoose")),React=_interopDefault(require("react")),primitives=require("@react-pdf/primitives"),_regeneratorRuntime=_interopDefault(require("@babel/runtime/regenerator")),_asyncToGenerator=_interopDefault(require("@babel/runtime/helpers/asyncToGenerator")),BlobStream=_interopDefault(require("blob-stream")),FontStore=_interopDefault(require("@react-pdf/font")),renderPDF=_interopDefault(require("@react-pdf/render")),PDFDocument=_interopDefault(require("@react-pdf/pdfkit")),layoutDocument=_interopDefault(require("@react-pdf/layout")),ReactFiberReconciler=_interopDefault(require("react-reconciler")),scheduler=require("scheduler"),propsEqual=function e(r,n){var t=Object.keys(r),o=Object.keys(n);if(t.length!==o.length)return!1;for(var i=0;i<t.length;i+=1){var u=t[i];if("render"===u&&!r[u]!=!n[u])return!1;if("children"!==u&&r[u]!==n[u]){if("object"==typeof r[u]&&"object"==typeof n[u]&&e(r[u],n[u]))continue;return!1}if("children"===u&&("string"==typeof r[u]||"string"==typeof n[u]))return r[u]===n[u]}return!0},emptyObject={},createRenderer=function(e){var r=e.onChange,n=void 0===r?function(){}:r;return ReactFiberReconciler({schedulePassiveEffects:scheduler.unstable_scheduleCallback,cancelPassiveEffects:scheduler.unstable_cancelCallback,supportsMutation:!0,isPrimaryRenderer:!1,warnsIfNotActing:!1,appendInitialChild:function(e,r){e.children.push(r)},createInstance:function(e,r){var n=r.style;r.children;return{type:e,box:{},style:n||{},props:_objectWithoutPropertiesLoose(r,["style","children"])||{},children:[]}},createTextInstance:function(e,r){return{type:"TEXT_INSTANCE",value:e}},finalizeInitialChildren:function(e,r,n){return!1},getPublicInstance:function(e){return e},prepareForCommit:function(){},prepareUpdate:function(e,r,n,t){return!propsEqual(n,t)},resetAfterCommit:n,resetTextContent:function(e){},getRootHostContext:function(){return emptyObject},getChildHostContext:function(){return emptyObject},shouldSetTextContent:function(e,r){return!1},now:Date.now,useSyncScheduling:!0,appendChild:function(e,r){e.children.push(r)},appendChildToContainer:function(e,r){"ROOT"===e.type?e.document=r:e.children.push(r)},insertBefore:function(e,r,n){var t=e.children.indexOf(n);-1!==t&&r&&e.children.splice(t,0,r)},removeChild:function(e,r){var n=e.children.indexOf(r);-1!==n&&e.children.splice(n,1)},removeChildFromContainer:function(e,r){var n=e.children.indexOf(r);-1!==n&&e.children.splice(n,1)},commitTextUpdate:function(e,r,n){e.value=n},commitUpdate:function(e,r,n,t,o){var i=o.style,u=_objectWithoutPropertiesLoose(o,["style"]);e.props=u,e.style=i}})},version="2.0.0-beta.13",fontStore=new FontStore,pdf=function(e){var r=e.initialValue,n=e.onChange,t={type:"ROOT",document:null},o=createRenderer({onChange:n}),i=o.createContainer(t),u=function(e){o.updateContainer(e,i,null)};r&&u(r);var a=function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(){var r,n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new PDFDocument({autoFirstPage:!1}),e.next=3,layoutDocument(t.document,fontStore);case 3:return n=e.sent,e.abrupt("return",renderPDF(r,n));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c=function(e){void 0===e&&(e={}),t.document.props.onRender&&t.document.props.onRender(e)};return{container:t,toBlob:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(){var r,n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:return r=e.sent,n=r.pipe(BlobStream()),e.abrupt("return",new Promise(function(e,r){n.on("finish",function(){try{var t=n.toBlob("application/pdf");c({blob:t}),e(t)}catch(e){r(e)}}),n.on("error",r)}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),toBuffer:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(){return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(),e.abrupt("return",a());case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),toString:function(){var e=_asyncToGenerator(_regeneratorRuntime.mark(function e(){var r,n;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.next=3,a();case 3:return n=e.sent,e.abrupt("return",new Promise(function(e,t){try{n.on("data",function(e){r+=e}),n.on("end",function(){e(r)})}catch(e){t(e)}}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),updateContainer:u}},Font=fontStore,StyleSheet={create:function(e){return e}},queue=require("queue"),InternalBlobProvider=function(e){function r(){for(var r,n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return(r=e.call.apply(e,[this].concat(t))||this).renderQueue=queue({autostart:!0,concurrency:1}),r.state={blob:null,url:null,loading:!0,error:null},r.queueDocumentRender=function(){r.renderQueue.splice(0,r.renderQueue.length,function(){return r.state.error?Promise.resolve():r.instance.toBlob()})},r.onRenderFailed=function(e){r.setState({error:e}),console.error(e)},r.onRenderSuccessful=function(e){var n=r.state.url;r.setState({blob:e,url:URL.createObjectURL(e),loading:!1},function(){return URL.revokeObjectURL(n)})},r}_inheritsLoose(r,e);var n=r.prototype;return n.componentDidMount=function(){this.instance=pdf({onChange:this.queueDocumentRender}),this.instance.updateContainer(this.props.document),this.renderQueue.on("error",this.onRenderFailed),this.renderQueue.on("success",this.onRenderSuccessful)},n.componentDidUpdate=function(){this.instance.updateContainer(this.props.document)},n.componentWillUnmount=function(){this.renderQueue.end()},n.render=function(){return this.props.children(this.state)},r}(React.PureComponent),BlobProvider=function(e){var r=e.document,n=e.children;return r?React.createElement(InternalBlobProvider,{document:r},n):(console.warn("You should pass a valid document to BlobProvider"),null)},PDFViewer=function(e){var r=e.className,n=e.style,t=e.title,o=e.children,i=e.innerRef,u=_objectWithoutPropertiesLoose(e,["className","style","title","children","innerRef"]);return React.createElement(InternalBlobProvider,{document:o},function(e){var o=e.url;return React.createElement("iframe",_extends({src:o,title:t,ref:i,style:n,className:r},u))})},PDFDownloadLink=function(e){var r=e.document,n=e.className,t=e.style,o=e.children,i=e.fileName,u=void 0===i?"document.pdf":i;if(!r)return console.warn("You should pass a valid document to PDFDownloadLink"),null;return React.createElement(InternalBlobProvider,{document:r},function(e){return React.createElement("a",{style:t,href:e.url,download:u,className:n,onClick:(r=e.blob,function(){window.navigator.msSaveBlob&&window.navigator.msSaveBlob(r,u)})},"function"==typeof o?o(e):o);var r})},throwEnvironmentError=function(e){throw new Error(e+" is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.")},renderToStream=function(){throwEnvironmentError("renderToStream")},renderToString=function(){throwEnvironmentError("renderToString")},renderToFile=function(){throwEnvironmentError("renderToFile")},render=function(){throwEnvironmentError("render")},dom=_extends({pdf:pdf,Font:Font,version:version,StyleSheet:StyleSheet,PDFViewer:PDFViewer,BlobProvider:BlobProvider,PDFDownloadLink:PDFDownloadLink,renderToStream:renderToStream,renderToString:renderToString,renderToFile:renderToFile,render:render},primitives);Object.keys(primitives).forEach(function(e){"default"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return primitives[e]}})}),exports.BlobProvider=BlobProvider,exports.Font=Font,exports.PDFDownloadLink=PDFDownloadLink,exports.PDFViewer=PDFViewer,exports.StyleSheet=StyleSheet,exports.default=dom,exports.pdf=pdf,exports.render=render,exports.renderToFile=renderToFile,exports.renderToStream=renderToStream,exports.renderToString=renderToString,exports.version=version;
//# sourceMappingURL=react-pdf.browser.cjs.min.js.map
